<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anode RBAC Implementation Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .share-btn {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 8px;
            transition: all 0.2s;
        }
        .share-btn:hover {
            background: #f1f3f4;
        }
        .modal-overlay {
            background: rgba(0, 0, 0, 0.5);
        }
        .permission-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 12px;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Demo Header -->
    <div class="bg-white border-b p-4">
        <h1 class="text-2xl font-bold text-gray-900">Anode RBAC Implementation Demo</h1>
        <p class="text-gray-600 mt-2">Simple role-based access control for collaborative notebooks</p>
    </div>

    <!-- Main Demo Area -->
    <div class="max-w-6xl mx-auto p-6">
        
        <!-- Notebook Header with Share Button -->
        <div class="bg-white border rounded-lg p-4 mb-6">
            <h2 class="text-lg font-semibold mb-4">Notebook Header (with Share Button)</h2>
            <nav class="bg-white border rounded-md px-4 py-2">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-4">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iOCIgZmlsbD0iIzY2NmQiLz4KPHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4PSI4IiB5PSI4Ij4KPHBhdGggZD0iTTggNkwxNiAxMEw4IDE0VjZaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4KPC9zdmc+" alt="Anode" class="h-8 w-auto">
                        <button class="inline-flex h-8 items-center justify-center rounded-md border border-gray-300 bg-white px-3 text-sm font-medium hover:bg-gray-50">
                            + Notebook
                        </button>
                    </div>

                    <div class="flex items-center gap-2">
                        <!-- Collaborative User Avatars -->
                        <div class="flex -space-x-2">
                            <div class="h-8 w-8 rounded-full border-2 border-blue-500 bg-blue-100 flex items-center justify-center">
                                <span class="text-xs font-medium text-blue-700">JD</span>
                            </div>
                            <div class="h-8 w-8 rounded-full border-2 border-green-500 bg-green-100 flex items-center justify-center">
                                <span class="text-xs font-medium text-green-700">AS</span>
                            </div>
                        </div>

                        <!-- Share Button -->
                        <button class="share-btn" title="Manage notebook permissions">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="18" cy="5" r="3"/>
                                <circle cx="6" cy="12" r="3"/>
                                <circle cx="18" cy="19" r="3"/>
                                <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
                                <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
                            </svg>
                        </button>

                        <!-- User Profile -->
                        <div class="h-8 w-8 rounded-full bg-gray-300 flex items-center justify-center">
                            <span class="text-xs font-medium text-gray-700">ME</span>
                        </div>
                    </div>
                </div>
            </nav>
        </div>

        <!-- Permission Manager Modal -->
        <div class="bg-white border rounded-lg p-4">
            <h2 class="text-lg font-semibold mb-4">Permission Manager Modal</h2>
            
            <div class="max-w-2xl bg-white rounded-lg shadow-lg border p-6">
                <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center gap-2">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-600">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                            <circle cx="9" cy="7" r="4"/>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                        </svg>
                        <h3 class="text-lg font-medium">Notebook Permissions</h3>
                    </div>
                    <button class="text-gray-500 hover:text-gray-700">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>

                <!-- Current Permissions -->
                <div class="mb-6">
                    <h4 class="text-sm font-medium text-gray-700 mb-3">Current Access</h4>
                    <div class="space-y-2">
                        <div class="permission-card">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-yellow-500">
                                        <polygon points="12,2 15.09,8.26 22,9 17,14 18.18,21 12,17.77 5.82,21 7,14 2,9 8.91,8.26"/>
                                    </svg>
                                    <div>
                                        <p class="text-sm font-medium text-gray-900">
                                            john.doe@example.com
                                            <span class="ml-2 text-xs text-gray-500">(You)</span>
                                        </p>
                                        <p class="text-xs text-gray-500">Owner • Added Jan 15, 2024</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="permission-card">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-blue-500">
                                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                                    </svg>
                                    <div>
                                        <p class="text-sm font-medium text-gray-900">alice.smith@example.com</p>
                                        <p class="text-xs text-gray-500">Editor • Added Jan 16, 2024</p>
                                    </div>
                                </div>
                                <button class="text-red-600 hover:text-red-700 hover:bg-red-50 p-1 rounded">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="3,6 5,6 21,6"/>
                                        <path d="M19,6v14a2,2 0 01-2,2H7a2,2 0 01-2-2V6m3,0V4a2,2 0 012-2h4a2,2 0 012,2v2"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add New User -->
                <div>
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="text-sm font-medium text-gray-700">Add User</h4>
                        <button class="flex items-center gap-1 border border-gray-300 rounded px-3 py-1 text-sm hover:bg-gray-50">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                            Add User
                        </button>
                    </div>

                    <div class="p-4 bg-gray-50 rounded-md space-y-3">
                        <div>
                            <label class="block text-xs font-medium text-gray-700 mb-1">
                                User ID or Email
                            </label>
                            <input
                                type="text"
                                placeholder="Enter user ID or email"
                                class="w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                value="bob.wilson@example.com"
                            />
                            <p class="text-xs text-gray-500 mt-1">
                                Enter the Google user ID or email address
                            </p>
                        </div>

                        <div>
                            <label class="block text-xs font-medium text-gray-700 mb-1">
                                Role
                            </label>
                            <select class="w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="editor">Editor - Can read and edit</option>
                                <option value="owner">Owner - Full control</option>
                            </select>
                        </div>

                        <div class="flex gap-2">
                            <button class="bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700">
                                Grant Access
                            </button>
                            <button class="border border-gray-300 px-4 py-2 rounded text-sm hover:bg-gray-50">
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Implementation Summary -->
        <div class="bg-white border rounded-lg p-6 mt-6">
            <h2 class="text-lg font-semibold mb-4">Implementation Summary</h2>
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-medium text-gray-900 mb-2">🔐 Security Features</h3>
                    <ul class="text-sm text-gray-600 space-y-1">
                        <li>• Permission checks at LiveStore connection</li>
                        <li>• Auto-ownership for new notebook creators</li>
                        <li>• Only owners can manage permissions</li>
                        <li>• Runtime agents bypass checks (trusted)</li>
                        <li>• Anonymous users bypass checks (dev mode)</li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-medium text-gray-900 mb-2">⚡ Key Components</h3>
                    <ul class="text-sm text-gray-600 space-y-1">
                        <li>• D1 database for permission storage</li>
                        <li>• REST API for permission management</li>
                        <li>• React components for UI</li>
                        <li>• Comprehensive test coverage</li>
                        <li>• Documentation and examples</li>
                    </ul>
                </div>
            </div>
            
            <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded">
                <p class="text-sm text-blue-800">
                    <strong>Ready for Production:</strong> This RBAC implementation provides the foundation for secure multi-user collaboration while maintaining simplicity and performance.
                </p>
            </div>
        </div>
    </div>
</body>
</html>